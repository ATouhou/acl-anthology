{"sections":[{"title":"A Noise Estimator with Rapid Adaptation in Variable-Level Noisy Environments Bing-Fei Wu, Kun-Ching Wang*, Lung-Yi Kuo Department of Electrical and Control Engineering National Chiao-Tung University Hsinchu, Taiwan, R.O.C.","paragraphs":["Corresponding author mail: Kunching@cssp.cn.nctu.edu.tw Abstract. In this paper, a noise estimator with rapid adaptation in a variable-level noisy environment is presented. To make noise estimation adapt quickly to highly non-stationary noise environments, a robust voice activity detector (VAD) is utilized in this paper and it depends on the variation of the spectral energy not on the amount of that. The noise power spectrum in subbands are estimated by averaging past spectral power values using a time and frequency dependent smoothing parameter, which is chosen as a sigmoid function changing with speech-present probability in subbands. The speech-present probability is determined by computing the ratio of the noisy speech power spectrum to its local minimum. Noise measurement, speech enhancement, spectral analysis, signal process."]},{"title":"1 Introduction","paragraphs":["An accurate noise estimator used for speech enhancement in adverse environments is one of most essential parts. Inaccurate noise estimator will result in a perceptually annoying residual noise and speech distortion. In general, noise estimation is usually done by explicit detection of speech detection. This can be very difficult in the case of varying background noise. Furthermore, the background noise is assumed to be related stationary between speech pause. To overcome these problems, the noise spectrum needs to be estimated and updated continuously with a reliable speech detector. Among those algorithms, a recursive averaging is a commonly and easily used approach. Martin [1] proposed a method which is based on minimum statistic (MS). The noise spectrum estimation is obtained by tracking the minimum of the noisy speech power spectrum over a specific window. To improve the computational complexity of estimating noise spectrum, Doblinger [2] proposed an efficient method. However, it fails to differentiate between a rise in noise power and a rise in speech power. Further, Cohen et al. [3] introduced a MCRA approach to estimate noise power spectrum using a smoothing parameter which is defined as the speech-present probability in subbands. The speech-present probability in subbands of a given frame can be determined by the ratio between the noisy speech power spectrum to its local minimum over a period of 0.5-1.5 sec. Finally, the ratio is compared to a specific threshold value to decide updating noise power or not. In recently, Lin et al. [4] proposed a simple and reliable noise estimation technique. To estimate subband noise adaptively and continuously, the smoothing parameter is adjusted by a sigmoid function. However, a variable-level of noise is not considered in this case. We summarize that the drawback of most methods are slow in adapting to suddenly increase level of noise. In this paper, a noise estimator with rapid adaptation in a variable level noisy environment is presented. It depends only on the variation of the spectral energy but not on the amount of that. Based on the VAD, a noise estimator updates the noise spectrum fast and accurately even in suddenly increases of noise. This paper is organized as follow. In order to make the estimator is robust against the time-varying level of noise. The utilized VAD in this algorithm is described in Section II. In Section III, the proposed noise estimation is presented in detail. In Section IV, the performance of the proposed method will be evaluated. Finally, we will discuss experimental results in Section V."]},{"title":"2 Voice Activity Detector","paragraphs":["Shen et al. [5] first used an entropy-based parameter for speech detection under adverse conditions. Their experimental results revealed that the spectral entropy of a speech signal differs from that of a non-speech signal. The procedure for calculating a spectral entropy parameter is described as follows. The short-time Fourier Transform (STFT) of a given time frame (,)s nl is given by,  1(,) (,)exp( 2 ), 1 ,M nx kl snl j kn M k Mπ ==⋅− ≤≤"]},{"title":"∑","paragraphs":["(1) where (,)x kl represents the spectral magnitude of the frequency component"]},{"title":"k","paragraphs":["in th l frame index, and"]},{"title":"M","paragraphs":["is the total number of frequency components in FFT ( 256M = in the proposed system). The spectral energy of each frame (,)energyx kl is described as follows. ","2 (,) (,) , 1 2,energyxklxkl kM=≤≤ (2) Then, the probability associated with each spectral energy component (,)rPml can be estimated by normalizing: 2 1 (,)","(,) , 1 2, (,) energy r M energy m xkl","Pkl k M xml = =≤≤"]},{"title":"∑","paragraphs":["(3) Following normalization, the corresponding spectral entropy lH for a given frame is defined as follows.  2 1 (,)log[1/ (,)], M","lr r kH Pkl Pkl ==⋅"]},{"title":"∑","paragraphs":["(4) The foregoing calculation of the spectral entropy parameter implies that the spectral entropy depends on the variation of the spectral energy not on the amount of that. Similarly, the spectral entropy parameter is robust against changing level of noise. Fig. 1 illustrates that the VAD can locate the speech-present regions, even in high level of background noise.   Fig. 1. Speech decision of a mixed signal (including a Factory noise)"]},{"title":"3 Proposed Noise Estimator","paragraphs":["Fig. 2 presents the flowchart of the proposed noise spectrum estimator. Let assume that noise ()dn and speech ()x n are uncorrelated. The smoothed power spectrum of noisy signal (,)Pkl is obtained by ","2 (,) (, 1) (1 ) (,)Pkl Pkl Y klηη=−+− , (5) where","2","(,)Ykl is an estimate of the short-time power spectrum of ()yn , given by () () ()yn xn dn=+. η is a smoothing constant. Since the noisy speech power spectrum in the speech-absent frames is equal to the noise power spectrum, the estimated noise power spectrum is updated by tracking the speech-absent. To make noise estimation track speech-absent quickly in highly non-stationary noise environments, a robust voice activity detector (VAD), which depends on the variation of the spectral energy not on the amount of that, is utilized in this section. First, computing the spectral entropy by Eqs. (1-4) during speech-present frame, a threshold σ is obtained as following: [], 1 5lcEH lσ = ×≤≤, (6) where c is constant by experiment. If the spectral entropy value for a given frame is smaller than the threshold σ , then the current frame is regarded as a speech-absent frame. Moreover, the noise estimate is updated according to: ","2","(,) (,) (1 ) (,)Nkl Nkl Yklλλ=⋅ +− ⋅ , (7) where λ is a constant parameter. Conversely, then the current frame is regarded as a speech-present frame. An algorithm that is suitable for estimating the noise spectrum during speech-present frame is used. First, finding the minimum of the noisy speech spectrum and using the minimum to determine signal-present probability in subbands. The signal-present probability is used to determine a time and frequency dependent smoothing parameter (,)klα , shown as following. ","2","(,) (,) (, 1) (1 (,)) (,)Nkl kl Nkl kl Yklαα=⋅−+− ⋅ . (8)","To speed up the determination of local minimum of noisy speech spectrum, Doblinger’s efficient method is used","here [2], which is not constrained by any window length to update noise spectrum estimate.  min min min If (, 1) (,), 1","then (,) (,1) ((,) (,1)), 1 else ( , ) ( , ), Pkl Pkl PklPkl PklPkl Pkl Pkl γ","γβ β −< −","=⋅ −+ −⋅ − − = (9) where min (,)Pkl denote the local minimum of the noisy speech power spectrum and β and γ are constants determined experimentally. Then, the local minimum is taken to determine speech-present probability (,)spPkl in subbands, which is similar to that proposed in [3], and the ratio is shown as below:  2 min (,) (,) (,) sp Ykl Pkl Pkl= . (10) To improve that a smoothing parameter is produced by comparing the ratio with a fixed threshold value [3], the smoothing parameter is chosen as a sigmoid function changing continuously with speech-present probability in subbands. The smoothing parameter is modified by ((,) (,))1","(,) 1 sp PrP kl T klkl","eα −−= + , (11) where (,)PTml denotes a adaptive threshold in subbands and is determined during speech-absent frames and shown as following:  22 2 ( , ) [ ( , )], all speech-absent frames, up to frame ( , ) [ ( , ) ], all speech-absent frames, up to frame (,) (,) (,) th mean th mean mean P mean NklENkii l Ykl EYki i l Ykl Tkl Nkl =∈ =∈ = , (12) FFT During speech-absent frame During speech-present frame Computing spectral entropy threshold by Eqs. (1-4) during speech-absent frame, [ ], 1 5lcEH lσ = ×≤≤ VAD using spectral entropy. If lH σ≥","The noise spectrum estimate is updated as following:","2 (,) (, ) (1 ) (,)Nkl Nkp l Yklλλ=⋅ −+− ⋅ Tracking adaptively thresholds in subbands 22 2 ( , ) [ ( , )], all speech-absent frames, up to frame ( , ) [ ( , ) ], all speech-absent frames, up to frame (,) (,) (,)","th me a n th me a n me","a","n","P me a n NklENkii l Ykl EYki i l Ykl Tkl Nkl =∈ =∈ = Finding the minimum of the noisy speech spectrum [1] mi n","mi","n m i n mi n If (, 1) (,) Then","1 (,) (, 1) ( (,) (, 1))","1 Else ( , ) ( , ) Pkl Pkl P kl P kl Pkl Pkl Pkl Pkl γ","γβ β −< −","= ⋅−+ −⋅− − =","Determining speech-presence probability in subbands [2] 2 min (,)","(,) (,)sp Ykl Pkl Pkl = Computing a time and frequency dependent smoothing parameter from a Sigmoid function [4] ((,) (,))1","(,) 1 sp","PrP kl T klkl eα −−= +","The noise spectrum estimate is updated as following:","2 (,) (,) (, 1) (1 (,)) (,)Nkl kl Nkl kl Yklαα=⋅−+− ⋅ No Yes  Fig. 2. The flowchart of the proposed noise spectrum estimator"]},{"title":"4 Experimental Results","paragraphs":["To evaluate the proposed noise estimator, the noisy speech is mixed with a suddenly increase level of Factory noise. Compare with Lin’s estimator [4], the results are shown in Fig. 3 and Fig. 4. Fig.3 illustrates the comparison of the proposed noise estimator between Lin’s one. Fig.3 (a) shows a phrase “May I Help You ?”, which is pronounced from a man in English. It is observed that a background noise suddenly increase in 22000th","sample (or 2.75 sec under 8KHz sampling rate). Then, the noise power spectrum is estimated by Lin’s noise estimator and a clean speech signal is produced by power spectral subtraction (PSS). The results are displayed in Fig.3 (b). It is observed that the noise is not removed completely later 22000th","sample (or 2.75 sec). Fig.3 (c) shows the estimated noise signal from Lin’s noise estimator. It is found that the suddenly increase level of Factory noise is detected in 22000th","sample; however, the amplitude of estimated noise is enough large to meet idea noise later 22000th","sample. Fig.3 (d) shows the clean signal is generated by the proposed noise estimator and PSS. Compare with Fig.3 (b), the proposed noise can be performed well in suddenly changing level of noise. In Fig.3 (e), the estimated noise signal is produced by the proposed method. Fig.4 shows the spectrograms of a noisy speech signal, an enhanced speech signal of Lin’s estimator and that of the proposed estimator, respectively. Similarly, due to the VAD is robust against a changing level of noise, the performance of speech enhancement in the proposed method is better than in Lin’s method. A noisy speech database is generated by applying various segmental SNRs in order to measure the segmental relative estimation error for various types and levels of noise. The segmental relative estimation error (SegErr) is defined by  2 1 2 0 [(,) (,)] 1 (, ) M m NmNm SegErr MNm ω ω ωω ω − = − ="]},{"title":"∑ ∑ ∑","paragraphs":[". (17) Table I shows the outcomes of the SegErr measured by the proposed estimation method for four noise types with the SNRs range [-5 to 25dB]. The proposed approach is superior to the other methods.    Fig. 3. Waveform of time signal "]},{"title":"(a) (b) (c)","paragraphs":["Fig. 4. Speech spectrogram (a) noisy speech signal (factory interior noise, suddenly raise in 2.75 sec) (b) speech enhanced with Lin’s noise estimator (c) speech enhanced with the proposed noise estimator Table 1. Example table "]},{"title":"5 Conclusion","paragraphs":["In this paper, a fast noise estimator, which is well suitable for suddenly varying level of noise, is presented. Based on the robust VAD, the speech decision can be determined accurately, and then the proposed algorithm can select the noise spectrum estimation which is suitable for the current frame. Unlike other method [1,3], the adaptation of this time and frequency dependent smoothing parameter does not depend on a specific time window and then updated continuously. Compare with Lin’s estimator, the experimental results illustrate that the proposed estimator can remove the noise power spectrum by PSS."]},{"title":"6 Acknowledgement","paragraphs":["The authors would like to thank the Promoting Academic Excellence of Universities for financially supporting this research under Contract No.91x104 Ex-91-E-FA06-4-4."]},{"title":"References","paragraphs":["[1] R. Martin, “Noise power spectral density estimation based on optimal smoothing and minimum statistics,” IEEE Trans. on Speech and Audio Processing, vol. 9, no. 5, pp. 504-512, July 2001. [2] G. Doblinger, “Computationally efficient speech enhancement by spectral minima tracking in subbands,” Proc. EUROSPEECH, pp. 1513-1516, 1995. [3] I. Cohen and B. Berdugo, “Noise estimation by minima controlled recursive averaging for robust speech enhancement,” IEEE Signal Processing Letters, vol. 9, no. 1, Jan. 2002. [4] L. Lin, W. H. Holmes, and E. Ambikairajah, “Adaptive noise estimation algorithm for speech enhancement,” Electronics Letters, vol. 39, no. 9, pp. 754-755, May, 2003. [5] J.L. Shen, J.W. Hung, and L.S. Lee, “Robust entropy-based endpoint detection for speech recognition in noisy environments,”Proc. ICSLP-98, 1998. "]}]}